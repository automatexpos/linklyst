{% extends "base.html" %}

{% block title %}{{ post.title }} | LinkLyst Blog{% endblock %}

{% block meta_description %}{{ post.meta_description or post.excerpt }}{% endblock %}

{% block canonical %}{{ request.url_root }}blog/{{ post.slug }}{% endblock %}

{% block head %}
<meta name="keywords" content="{{ post.meta_keywords }}">
<meta name="robots" content="{{ post.robots_meta or 'index,follow' }}">

<meta property="og:title" content="{{ post.title }}">
<meta property="og:description" content="{{ post.excerpt }}">
<meta property="og:type" content="article">
<meta property="og:url" content="{{ request.url_root }}blog/{{ post.slug }}">
<meta property="og:image" content="{{ post.featured_image or url_for('static', filename='images/og-image.svg') }}">

<link rel="stylesheet" href="{{ url_for('static', filename='blog.css') }}?v={{ range(1, 10000) | random }}" />
<script>
// Force blog styling on page load
document.addEventListener('DOMContentLoaded', function() {
    // Add blog-page class to body
    document.body.classList.add('blog-page');
    
    // Force body background override
    document.body.style.setProperty('background', '#fafafa', 'important');
    document.body.style.setProperty('background-image', 'none', 'important');
    document.body.style.setProperty('font-family', '-apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", sans-serif', 'important');
    
    // Also force on documentElement (html)
    document.documentElement.style.setProperty('background', '#fafafa', 'important');
    document.documentElement.style.setProperty('background-image', 'none', 'important');
    
    // Force the main container background
    const mainContainer = document.querySelector('main.container');
    if (mainContainer) {
        mainContainer.style.setProperty('background', '#fafafa', 'important');
        mainContainer.style.setProperty('background-image', 'none', 'important');
    }
    
    console.log('Blog styling forced via JavaScript');
});
</script>
{% endblock %}

{% block content %}
<div class="blog-page-wrapper" style="background: #fafafa !important; background-image: none !important; min-height: 100vh !important;">
<nav class="post-nav">
    <div class="nav-content">
        <a href="/blog" class="back-link">← Back to Blog</a>
    </div>
</nav>

<div class="post-container">
    <article>
        <header class="post-header">
            <div class="post-meta">
                {{ post.published_at.strftime('%B %d, %Y') if post.published_at else 'Draft' }}
                {% if post.author_name %} • By {{ post.author_name }}{% endif %}
                {% if post.reading_time %} • {{ post.reading_time }} min read{% endif %}
            </div>
            
            <h1 class="post-title">{{ post.title }}</h1>
            
            {% if post.excerpt %}
            <p class="post-excerpt">{{ post.excerpt }}</p>
            {% endif %}
        </header>

        {% if post.featured_image %}
        <img src="{{ post.featured_image }}" alt="{{ post.title }}" class="featured-image">
        {% endif %}

        <div class="post-content">
            {{ post.content|safe }}
        </div>

        {% if post.tags %}
        <div class="post-tags">
            {% for tag in post.tags.split(',') %}
            <a href="/blog/tag/{{ tag.strip()|lower }}" class="post-tag">#{{ tag.strip() }}</a>
            {% endfor %}
        </div>
        {% endif %}
    </article>

    <!-- Author Info -->
    {% if post.author_name %}
    <div class="author-info">
        <div class="author-name">{{ post.author_name }}</div>
        {% if post.author_bio %}
        <p class="author-bio">{{ post.author_bio }}</p>
        {% endif %}
    </div>
    {% endif %}

    <!-- Related Posts -->
    {% if related_posts %}
    <section class="related-posts">
        <h2 class="related-title">Related Posts</h2>
        <div class="related-grid">
            {% for related_post in related_posts %}
            <article class="related-post">
                <h3 class="related-post-title">
                    <a href="/blog/{{ related_post.slug }}">{{ related_post.title }}</a>
                </h3>
                <p class="related-post-excerpt">{{ related_post.excerpt|truncate(80) }}</p>
            </article>
            {% endfor %}
        </div>
    </section>
    {% endif %}
</div>
</div>
{% endblock %}